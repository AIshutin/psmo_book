# Семинар

## Задачи

```{admonition} Задача 1: Теорема Хершелла-Максвелла
:class: attention

Рассмотрим замкнутую плоскую фигуру внутри которой случайно летают частицы. Обозначим $V = (V_x, V_y)'$ -- вектор скоростей случайно выбранной частицы.
	
Предположим, что
1. Распределение вектора $V$ не должно меняться при его повороте на любой угол (то есть не зависит от направления вектора).
2. $V_x$ и $V_y$ независимы.
3. $\Var(V_x) = \Var(V_y) = 1$.
4. $f(v_x, v_y)$ существует и непрерывна.
	
**[а]** Найдите координаты вектора $V'$, который получается поворотом вектора $V$ на $90^{\circ}$ против часовой стрелки.

**[б]** Докажите, что распределения $V_x$, $V_y$ и $-V_y$ совпадают.

**[в]** По предположению 3 понятно, что $\Var(V_x) = \Var(V_y) = 1$. Покажите, что $\E(V_x) = \E(V_y) = 0$.

**[г]** Докажите, что совместная функция плотности $f_V(v_x, v_y)$ представима в виде

$f_V(v_x, v_y) = h(v_x^2 + v_y^2),$

где $h$ -- некоторая функция. Сделайте вывод из этого утверждения.

**[д]** Покажите, что совместная функция плотности $f_V(v_x, v_y)$ представима в виде

$f_V(v_x, v_y) = g(v_x^2)g(v_y^2),$

где $g$ -- некоторая функция.

**[е]** Докажите, что выражение $h'(t)/h(t)$ равно константе.

**[ё]** Найдите функцию $h(t)$ с точностью до константы.

**[ж]** Выпишите $f_V(v_x, v_y)$ с точностью до константы.
```

```{admonition} Задача 2: Независимость длин проекций
Пусть вектор $u \in \R^3$ имеет многомерное стандартное нормальное распределение.

**[а]** Найдите проекцию вектора $u$ на подпространство $V = \{(x_1, x_2, x_3) \text{ }| \text{ } x_1 = x_2 = x_3\}$.

**[б]** Найдите проекцию вектора $u$ на подпространство $W = \{(x_1, x_2, x_3) \text{ }| \text{ } x_2 = 0, x_1 = -x_3\}$.

**[в]** Являются ли $V$ и $W$ ортогональными?

**[г]** Убедитесь, что $\Vert\hat{u}_V\Vert$ и $\Vert\hat{u}_W\Vert$ независимы.
```

```{admonition} Задача 3: Распределение хи-квадрат
Пусть вектор $u \in \R^n$ имеет многомерное стандартное нормальное распределение. Пусть $V \subset \R^n$, $\dim V = k$. Тогда $\Vert\hat{u}_V\Vert^2 \sim \chi^2_k$.

**[а]** Пусть вектор $u \in \R^3$ имеет многомерное стандартное нормальное распределение. Найдите проекцию и распределение квадрата длины проекции вектора $u$ на подпространство $V = \{(x_1, x_2, x_3 \text{ } | \text{ } x_3 = 2x_1 + x_2)\}$.

**[б]** Найдите распределение квадрата длины проекции вектора $u$ на подпространство $V^{\perp}$.
```

```{admonition} Задача 4: F-распределение
Пусть случайные величины $X \sim \chi^2_{a}$, $Y \sim \chi^2_{b}$, и $X$ и $Y$ независимы. Тогда случайная величина $Z$ имеет распределение Фишера с $a$ и $b$ степенями свободы:

$Z = \dfrac{X/a}{Y/b} \sim F_{a, b}$

Пусть вектор $u \in \R^n$ имеет многомерное стандартное нормальное распределение. Пусть $V$ и $W$ -- ортогональные подпространства в $\R^n$, $\dim V = k$. $\dim W = m$.

**[а]** Постройте проекции вектора $u$ на $V$ и $W$. Как распределены квадраты длин этих проекций?

**[б]** Постройте проекцию вектора $u$ на $(V + W)$.

**[в]** Покажите на рисунке угол, квадрат тангенса которого равен отношению квадратов длин проекций $u$ на $V$ и $W$. Обозначим этот угол как $\alpha$.

**[г]** Какое распределение имеет величина

$\dfrac{m}{k}\tan^2 \alpha ?$

**[д]** Поясните идею сравнения прогнозов моделей при помощи $F$-распределения.
```

```{admonition} Задача 5: Применение F-распределения
Пусть имеются UR-модель и R-модель и тестируется гипотеза 

$H_0: \text{Верны и UR- и R-модели}$

против

$H_A: \text{UR-модель верна, а R-модель неверна.}$

Тогда $H_0$ отвергается на уровне значимости $\alpha$, если $F$-статистика

$F = \dfrac{(RSS_{R} - RSS_{UR})/(\text{df}_{R} - \text{df}_{UR})}{RSS_{UR} / \text{df}_{UR}}$

превышает критическое значение $F_{\alpha}$. Здесь $df$ -- число степеней свободы в соответствующей модели, $df = n - k$, где $n$ -- число наблюдений, $k$ -- число регрессоров.

Пусть UR-модель задаётся следующим образом:

$y_i = \beta_0 + \beta_1x_i + \beta_2z_i + u_i$

Тестируется следующая R-модель:

$y_i = \beta_0 + \beta_1(x_i + z_i) + u_i$

	
Предположим, что $u_i \sim \mathcal{N}(0, 1)$ и независимы.
	
**[а]** Постройте подпространства $V_{UR}$ и $V_{R}$ и проекции вектора $y$ на них.

**[б]** Покажите $RSS_{UR}$ и $RSS_{R}$. Обозначим угол между ними как $\alpha$.

**[в]** Покажите, что $RSS_{R} - RSS_{UR} = \Vert \hat{y}_{UR} - \hat{y}_{R} \Vert^2$.

**[г]** Выразите $\tan^2 \alpha$ через $y$,  $\hat{y}_{UR}$, $\hat{y}_{R}$.

**[д]** Рассмотрим векторы $y - \hat{y}_{UR}$ и $\hat{y}_{UR} - \hat{y}_{R}$. Найдите размерности подпространств, в которых они лежат. 

**[е]** Выпишите $F$-статистику в геометрическом и в классическом смыслах.
	